---
title: "648 Lab 3"
author: "gucci fan"
date: "2024-11-16"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(readr)
library(ggplot2)
library(ggthemes)
library(gganimate)
library(foreign)
library(dplyr)
library(rnaturalearth)
library(rnaturalearthdata)
library(gifski)
library(lubridate)
#library(tidyverse)
library(wesanderson)

```

```{r}
MichFlickr <- read.csv("MichiganFlickr.csv")
```

```{r}
MichFlickr$date <- as.POSIXct(MichFlickr$dateupload, origin="1970-01-01")
MichFlickr$date <- as.Date(format(MichFlickr$date, format="%Y-%m-%d")) # lubridate function, simplifying
###We will also give it a value. We want to count the number of photos 
MichFlickr$year <- year(MichFlickr$date)
MichFlickr$month <- month(MichFlickr$date, label = TRUE)
MichFlickr$day <- day(MichFlickr$date)
MichFlickr$count<- 1
MichFlickr$Nature<- MichFlickr$predict_Na > 0.6
```

I want to investigate the spatial distribution of photos in relation to their classified land use, as well as compare that to whether the photo was classified as nature or not nature. I am first sorting by land use type, and dropping data points where land use was 0.

```{r}
unique(MichFlickr$Landuse)
sum(MichFlickr$Landuse == 41)
nature_false <- sum(MichFlickr$Nature == FALSE)
nature_true <- sum(MichFlickr$Nature == TRUE)
proportion_nature <- nature_true / sum(nature_true + nature_false)

landuse_freq <- MichFlickr %>% filter(Landuse != 0) %>%
  group_by(Landuse) %>%
  summarise(total_photos=sum(count)) %>%
  na.omit()
head(landuse_freq)

landuse_labels <- c("Open Water", "Developed, Open Space", "Developed, Low Intensity", "Developed, Medium Intensity", "Developed, High Intensity", "Barren Land (Rock/Sand)", "Deciduous Forest", "Evergreen Forest", "Mixed Forest", "Shrub/Scrub", "Grassland/Herbaceous", "Pasture/Hay", "Cultivated Crops", "Woody Wetlands", "Emergent Herbaceous Wetlands")

landuse_freq <- landuse_freq %>%
  mutate(Proportion = total_photos / sum(total_photos))

ggplot(landuse_freq, aes(x = "", y = Proportion, fill = factor(Landuse))) +
  geom_bar(stat = "identity", width = 1, color = "white") +
  coord_polar("y", start = 0) + 
  labs(fill = "Land Use Type", y = NULL, x = NULL, 
       title = "Proportions of Land Use Types") +
  theme_void() +  
  geom_text(aes(label = scales::percent(Proportion, accuracy = 0.01)), 
            position = position_stack(vjust = 0.5), size=3) +
  scale_fill_manual(values = c("#486da1", "#e1cdce", "#dc9881", "#f10100", "#ab0101", "#b3afa4", "#6ca966", "#1d6533", "#bdcc93", "#d1bb82", "#edeccc", "#ded83e", "#ae7229", "#bbd7ed", "#71a4c1"),
                    labels = landuse_labels)

```

From this pie chart, the pink to red slices represent developed land use types and they are about half of the entire dataset. In the non-developed slices, open water, deciduous forest, and cultivated crops make up the most significant "nature" type land uses.

```{r}

count_developed <- landuse_freq %>%
  filter(Landuse %in% c(21, 22, 23, 24)) %>% 
  summarise(total_photos = sum(total_photos)) 

developed_proportion <- count_developed$total_photos / sum(landuse_freq$total_photos)
## not working

developed_proportion
```
A little over half of the photos, or 55.73%, were taken at a location classified as one of the "developed" NLCD land use types - 21: Developed open space, 22: Developed low intensity, 23: Developed medium intensity, or 24: Developed high intensity. I wanted to compare this with the proportion of nature vs non-nature photographs (classified independently of land use). Basically, do people take photos of nature at locations classified as non-developed? What would cause discrepancies?




